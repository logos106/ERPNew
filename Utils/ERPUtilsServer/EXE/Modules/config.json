{
    "MapDescription":"Fuel Spreadsheet",
    "InputFile":
    {
        "DataType":"CSV",
		"DataFormatParams":{
			"FieldSep":",",
			"QuotedStrings":false,
			"NumberOfColumns":22
		},
		"Filters":[
			{
				"ColumnNumber":1,
				"SelectWhen":"DataValid"
			}
		],
        "Columns":
        {
            "1":
            {
                "Name":"Transaction Date \/Time",
                "DataType":"DateTime",
                "DateFormat":"d/mm/yyyy",
				"TimeFormat":"h:nn",
                "Required":true
            },
            "3":
            {
                "Name":"Card Number",
                "DataType":"String",
                "Required":true
            },
            "5":
            {
                "Name":"Driver",
                "DataType":"String",
                "Required":true
            },
            "13":
            {
                "Name":"Odometer",
                "DataType":"Integer"
            },
            "14":
            {
                "Name":"Product",
                "DataType":"Integer",
                "Required":true
            },
            "15":
            {
                "Name":"Quantity",
                "DataType":"Float"
            },
            "16":
            {
                "Name":"Docket Amount (Incl GST)",
                "DataType":"Currency"
            },
            "17":
            {
                "Name":"Pump Price (Incl GST)",
                "DataType":"Currency"
            },
            "18":
            {
                "Name":"Shell Card Amount (Excel GST)",
                "DataType":"Currency"
            },
            "19":
            {
                "Name":"GST",
                "DataType":"Currency"
            },
            "20":
            {
                "Name":"Shell Card Amount (Incl GST)",
                "DataType":"Currency"
            },
            "21":
            {
                "Name":"Shell Card Price (Incl GST)",
                "DataType":"Currency"
            }
        }
    },
	"Mapping":{
		"Invoice":{
			"Target":{
				"ERPClassName":"TInvoice",
				"NewRecordOn":{
					"ChangeType":"Column",
					"Params":{
						"Columns":[1,3],
						"Relationship":"or"
					}	
				},	
				"Line":{
					"PropertyName":"Lines",
					"NewRecordOn":{
						"ChangeType":"Row"
					}
				}
			}
			"Map":[
				{
					"Source":{
						"ColumnNumber":3
						"StringReplace":{
							"SearchString":" ",
							"ReplaceString":"",
							"ReplaceAll":true,
							"IgnoreCase":true
						}
					},
					"Target":{
						"Field":"JobName"
					}
				},
				{
					"Source":{
						"ColumnNumber":1
					},
					"Target":{
						"Field":"SaleDate"
					}
				},
				{
					"Source":{
						"ColumnNumber":8
					},
					"Target":{
						"Field":"Comments",
						"Separator":"\r\n"
					}
				},
				{
					"Source":{
						"ColumnNumber":10
					},
					"Target":{
						"Field":"Comments",
						"Separator":"\r\n"
					}
				},
				{
					"Source":{
						"ColumnNumber":13
					},
					"Target":{
						"Field":"CustPONumber"
				},
				{
					"Source":{
						"Value":"Web User"
					},
					"Target":{
						"Field":"EmployeeName"
					}
				},
				{
					"Source":{
						"ColumnNumber":14
					},
					"Target":{
						"Field":"Lines.ProductName"
					}
				},
				{
					"Source":{
						"ColumnNumber":12
					},
					"Target":{
						"Field":"Lines.DocketNumber"
					}
				},
				{
					"Source":{
						"ColumnNumber":3
					},
					"Target":{
						"Field":"Lines.MemoLine"
					}
				},
				{
					"Source":{
						"ColumnNumber":15
					},
					"Target":{
						"Field":"Lines.UOMOrderQty"
					}
				},
				{
					"Source":{
						"ColumnNumber":15
					},
					"Target":{
						"Field":"Lines.UOMQtyShipped"
					}
				},
				{
					"Source":{
						"ColumnNumber":16
					},
					"Target":{
						"Field":"Lines.TotalLineAmountInc"
					}
				}
			]
		}	
		"PO":{
			"Target":{
				"ERPClassName":"TPurchaseOrder"
			}
		}	
		
	}	
}
