unit TransactionExpressUtils;

interface

  function DecodeTransactionResponse(const aCode: string; var msg: string): boolean;
  function DecodeErrorCode(const aCode: string): string;

implementation

uses
  SysUtils;

function DecodeTransactionResponse(const aCode: string; var msg: string): boolean;
begin
  result := false;
  if SameText(aCode, '00') then begin
    msg := 'Approved or completed successfully';
    result := true;
  end
  else if SameText(aCode, '01') then msg := 'Refer to card issuer'
  else if SameText(aCode, '02') then msg := 'Refer to card issuer, special condition'
  else if SameText(aCode, '03') then msg := 'Invalid merchant'
  else if SameText(aCode, '04') then msg := 'Pick-up card'
  else if SameText(aCode, '05') then msg := 'Do not honor'
  else if SameText(aCode, '06') then msg := 'Error'
  else if SameText(aCode, '07') then msg := 'Pick-up card, special condition'
  else if SameText(aCode, '08') then msg := 'Declined: Honor with identification (this is a decline response when a card not present transaction)'
  else if SameText(aCode, '09') then msg := 'Request in progress'
  else if SameText(aCode, '10') then begin
    msg := 'Approved, partial authorization';
    result := true;
  end
  else if SameText(aCode, '11') then msg := 'Declined: VIP (this is a decline response for a card not present transaction)'
  else if SameText(aCode, '12') then msg := 'Invalid transaction'
  else if SameText(aCode, '13') then msg := 'Invalid amount'
  else if SameText(aCode, '14') then msg := 'Invalid card number'
  else if SameText(aCode, '15') then msg := 'No such issuer'
  else if SameText(aCode, '16') then msg := 'Declined: update track 3'
  else if SameText(aCode, '17') then msg := 'Customer cancellation'
  else if SameText(aCode, '18') then msg := 'Customer dispute'
  else if SameText(aCode, '19') then msg := 'Re-enter transaction'
  else if SameText(aCode, '20') then msg := 'Invalid response'
  else if SameText(aCode, '21') then msg := 'No action taken'
  else if SameText(aCode, '22') then msg := 'Suspected malfunction'
  else if SameText(aCode, '23') then msg := 'Unacceptable transaction fee'
  else if SameText(aCode, '24') then msg := 'File update not supported'
  else if SameText(aCode, '25') then msg := 'Unable to locate record'
  else if SameText(aCode, '26') then msg := 'Duplicate record'
  else if SameText(aCode, '27') then msg := 'File update field edit error'
  else if SameText(aCode, '28') then msg := 'File update file locked'
  else if SameText(aCode, '29') then msg := 'File update failed'
  else if SameText(aCode, '30') then msg := 'Format error'
  else if SameText(aCode, '31') then msg := 'Bank not supported'
  else if SameText(aCode, '33') then msg := 'Expired card, pick-up'
  else if SameText(aCode, '34') then msg := 'Suspected fraud, pick-up'
  else if SameText(aCode, '35') then msg := 'Contact acquirer, pick-up'
  else if SameText(aCode, '36') then msg := 'Restricted card, pick-up'
  else if SameText(aCode, '37') then msg := 'Call acquirer security, pick-up'
  else if SameText(aCode, '38') then msg := 'PIN tries exceeded, pick-up'
  else if SameText(aCode, '39') then msg := 'No credit account'
  else if SameText(aCode, '40') then msg := 'Function not supported'
  else if SameText(aCode, '41') then msg := 'Lost card, pick-up'
  else if SameText(aCode, '42') then msg := 'No universal account'
  else if SameText(aCode, '43') then msg := 'Stolen card, pick-up'
  else if SameText(aCode, '44') then msg := 'No investment account'
  else if SameText(aCode, '45') then msg := 'Account closed'
  else if SameText(aCode, '46') then msg := 'Identification required'
  else if SameText(aCode, '47') then msg := 'Identification cross-check required'
  else if SameText(aCode, '48') then msg := 'No customer record'
  else if SameText(aCode, '49') then msg := 'Reserved for future Realtime use'
  else if SameText(aCode, '50') then msg := 'Reserved for future Realtime use'
  else if SameText(aCode, '51') then msg := 'Not sufficient funds'
  else if SameText(aCode, '52') then msg := 'No checking account'
  else if SameText(aCode, '53') then msg := 'No savings account'
  else if SameText(aCode, '54') then msg := 'Expired card'
  else if SameText(aCode, '55') then msg := 'Incorrect PIN'
  else if SameText(aCode, '56') then msg := 'No card record'
  else if SameText(aCode, '57') then msg := 'Transaction not permitted to cardholder'
  else if SameText(aCode, '58') then msg := 'Transaction not permitted on termina'
  else if SameText(aCode, '59') then msg := 'Suspected fraud'
  else if SameText(aCode, '60') then msg := 'Contact acquirer'
  else if SameText(aCode, '61') then msg := 'Exceeds withdrawal limit'
  else if SameText(aCode, '62') then msg := 'Restricted card'
  else if SameText(aCode, '63') then msg := 'Security violation'
  else if SameText(aCode, '64') then msg := 'Original amount incorrect'
  else if SameText(aCode, '65') then msg := 'Exceeds withdrawal frequency'
  else if SameText(aCode, '66') then msg := 'Call acquirer security'
  else if SameText(aCode, '67') then msg := 'Hard capture'
  else if SameText(aCode, '68') then msg := 'Response received too late'
  else if SameText(aCode, '69') then msg := 'Advice received too late (the response from a request was received too late )'
  else if SameText(aCode, '70') then msg := 'Reserved for future use'
  else if SameText(aCode, '71') then msg := 'Reserved for future Realtime use'
  else if SameText(aCode, '72') then msg := 'Reserved for future Realtime use'
  else if SameText(aCode, '73') then msg := 'Reserved for future Realtime use'
  else if SameText(aCode, '74') then msg := 'Reserved for future Realtime use'
  else if SameText(aCode, '75') then msg := 'PIN tries exceeded'
  else if SameText(aCode, '76') then msg := 'Reversal: Unable to locate previous message (no match on Retrieval Reference Number)/ Reserved for future Realtime use'
  else if SameText(aCode, '77') then msg := 'Previous message located for a repeat or reversal, but repeat or reversal data is inconsistent with original message/ Intervene, bank approval required'
  else if SameText(aCode, '78') then msg := 'Invalid/non-existent account – Decline (MasterCard specific)/ Intervene, bank approval required for partial amount'
  else if SameText(aCode, '79') then msg := 'Already reversed (by Switch)/ Reserved for client-specific use (declined)'
  else if SameText(aCode, '80') then msg := 'No financial Impact (Reserved for declined debit)/ Reserved for client-specific use (declined)'
  else if SameText(aCode, '81') then msg := 'PIN cryptographic error found by the Visa security module during PIN decryption/ Reserved for client-specific use (declined)'
  else if SameText(aCode, '82') then msg := 'Incorrect CVV/ Reserved for client-specific use (declined)'
  else if SameText(aCode, '83') then msg := 'Unable to verify PIN/ Reserved for client-specific use (declined)'
  else if SameText(aCode, '84') then msg := 'Invalid Authorization Life Cycle – Decline (MasterCard) or Duplicate Transaction Detected (Visa)/ Reserved for client-specific use (declined)'
  else if SameText(aCode, '85') then msg := 'No reason to decline a request for Account Number Verification or Address Verification/ Reserved for client-specific use (declined)'
  else if SameText(aCode, '86') then msg := 'Cannot verify PIN/ Reserved for client-specific use (declined)'
  else if SameText(aCode, '87') then msg := 'Reserved for client-specific use (declined)'
  else if SameText(aCode, '88') then msg := 'Reserved for client-specific use (declined)'
  else if SameText(aCode, '89') then msg := 'Reserved for client-specific use (declined)'
  else if SameText(aCode, '90') then msg := 'Cut-off in progress'
  else if SameText(aCode, '91') then msg := 'Issuer or switch inoperative'
  else if SameText(aCode, '92') then msg := 'Routing error'
  else if SameText(aCode, '93') then msg := 'Violation of law'
  else if SameText(aCode, '94') then msg := 'Duplicate Transmission (Integrated Debit and MasterCard)'
  else if SameText(aCode, '95') then msg := 'Reconcile error'
  else if SameText(aCode, '96') then msg := 'System malfunction'
  else if SameText(aCode, '97') then msg := 'Reserved for future Realtime use'
  else if SameText(aCode, '98') then msg := 'Exceeds cash limit'
  else if SameText(aCode, '99') then msg := 'Reserved for future Realtime use'
  else if SameText(aCode, '1106') then msg := 'Reserved for future Realtime use'
  else if SameText(aCode, '0A') then msg := 'Reserved for future Realtime use'
  else if SameText(aCode, 'A0') then msg := 'Reserved for future Realtime use'
  else if SameText(aCode, 'A1') then msg := 'ATC not incremented'
  else if SameText(aCode, 'A2') then msg := 'ATC limit exceeded'
  else if SameText(aCode, 'A3') then msg := 'ATC configuration error'
  else if SameText(aCode, 'A4') then msg := 'CVR check failure'
  else if SameText(aCode, 'A5') then msg := 'CVR configuration error'
  else if SameText(aCode, 'A6') then msg := 'TVR check failure'
  else if SameText(aCode, 'A7') then msg := 'TVR configuration error'
//  else if SameText(aCode, 'A8 to BZ Reserved for future Realtime use
  else if SameText(aCode, 'B1') then msg := 'Surcharge amount not permitted on Visa cards or EBT Food Stamps/ Reserved for future Realtime use'
  else if SameText(aCode, 'B2') then msg := 'Surcharge amount not supported by debit network issuer/ Reserved for future Realtime use'
  else if SameText(aCode, 'C0') then msg := 'Unacceptable PIN'
  else if SameText(aCode, 'C1') then msg := 'PIN Change failed'
  else if SameText(aCode, 'C2') then msg := 'PIN Unblock failed'
  else if SameText(aCode, 'C3') then msg := 'to D0 Reserved for future Realtime use'
  else if SameText(aCode, 'D1') then msg := 'MAC Error'
//  else if SameText(aCode, 'D2 to E0 Reserved for future Realtime use
  else if SameText(aCode, 'E1') then msg := 'Prepay error'
//  else if SameText(aCode, 'E2 to MZ Reserved for future Realtime use
  else if SameText(aCode, 'N1') then msg := 'Network Error within the TXP platform'
//  else if SameText(aCode, 'N0 to ZZ Reserved for client-specific use (declined) (except N1)
  else if SameText(aCode, 'N0') then msg := 'Force STIP/ Reserved for client-specific use (declined)'
  else if SameText(aCode, 'N3') then msg := 'Cash service not available/ Reserved for client-specific use (declined)'
  else if SameText(aCode, 'N4') then msg := 'Cash request exceeds Issuer limit/ Reserved for client-specific use (declined)'
  else if SameText(aCode, 'N5') then msg := 'Ineligible for re-submission/ Reserved for client-specific use (declined)'
  else if SameText(aCode, 'N7') then msg := 'Decline for CVV2 failure/ Reserved for client-specific use (declined)'
  else if SameText(aCode, 'N8') then msg := 'Transaction amount exceeds preauthorized approval amount/ Reserved for client-specific use (declined)'
  else if SameText(aCode, 'P0') then msg := 'Approved; PVID code is missing, invalid, or has expired'
  else if SameText(aCode, 'P1') then msg := 'Declined; PVID code is missing, invalid, or has expired/ Reserved for client-specific use (declined)'
  else if SameText(aCode, 'P2') then msg := 'Invalid biller Information/ Reserved for client-specific use (declined)/ Reserved for client-specific use (declined)'
  else if SameText(aCode, 'R0') then msg := 'The transaction was declined or returned, because the cardholder requested that payment of a specific recurring or installment payment transaction be stopped/ Reserved for client-specific use (declined)'
  else if SameText(aCode, 'R1') then msg := 'The transaction was declined or returned, because the cardholder requested that payment of all recurring or installment payment transactions for a specific merchant account be stopped/ Reserved for client-specific use (declined)'
  else if SameText(aCode, 'Q1') then msg := 'Card Authentication failed/ Reserved for client-specific use (declined)'
  else if SameText(aCode, 'XA') then msg := 'Forward to Issuer/ Reserved for client-specific use (declined)'
  else if SameText(aCode, 'XD') then msg := 'Forward to Issuer/ Reserved for client-specific use (declined)'
  else msg := 'Unknown error: ' + aCode;
end;

function DecodeErrorCode(const aCode: string): string;
begin
  result := '';
  if SameText(aCode, '10000') then result := 'Undefined Error.'
  else if SameText(aCode, '10013') then result := 'Invalid App Key.'
  else if SameText(aCode, '10014') then result := 'Unable to Validate App Key.'
  else if SameText(aCode, '11502') then result := 'Bad Gateway'
  else if SameText(aCode, '11504') then result := 'Gateway Timeout'
  else if SameText(aCode, '50000') then result := 'Undefined error code. Please check the error message.'
  else if SameText(aCode, '50001') then result := 'Database exception.'
  else if SameText(aCode, '50002') then result := 'Unhandled exception.'
  else if SameText(aCode, '50003') then result := 'This is returned if the following is true:  No response was received from the upstream entity (i.e., eSocket Server) for a given amount of time. Default is 30 seconds.'
  else if SameText(aCode, '50004') then result := 'No record found.'
  else if SameText(aCode, '50005') then result := 'Too many records found.'
  else if SameText(aCode, '50006') then result := 'Record already exists.'
  else if SameText(aCode, '50007') then result := 'Database access failure.'
  else if SameText(aCode, '50008') then result := 'Authentication failed because of incomplete information (e.g., password not specified).'
  else if SameText(aCode, '50009') then result := 'No record updated.'
  else if SameText(aCode, '50010') then result := 'Access denied.'
  else if SameText(aCode, '50011') then result := 'Schema validation error.'
  else if SameText(aCode, '50012') then result := 'Authentication failed because of wrong information (e.g., wrong password).'
  else if SameText(aCode, '50013') then result := 'System failure.'
  else if SameText(aCode, '50014') then result := 'User is active but locked.'
  else if SameText(aCode, '50015') then result := 'User is inactive.'
  else if SameText(aCode, '50016') then result := 'User is inactive and locked.'
  else if SameText(aCode, '50017') then result := 'Password is expired.'
  else if SameText(aCode, '50019') then result := 'User must change password.'
  else if SameText(aCode, '50020') then result := 'Old password and new password are the same but not expected.'
  else if SameText(aCode, '50021') then result := 'Request is expected but not set.'
  else if SameText(aCode, '50022') then result := 'User is not linked to a merchant or group.'
  else if SameText(aCode, '50023') then result := 'Password or Registration Key failed WSDL validation.'
  else if SameText(aCode, '50024') then result := 'Failed to send email.'
  else if SameText(aCode, '50025') then result := 'User ID and password are set, but Merchant ID is not set.'
  else if SameText(aCode, '50026') then result := 'Active/Active initialization failed.'
  else if SameText(aCode, '50027') then result := 'Encryption/decryption failed.'
  else if SameText(aCode, '50028') then result := 'Invalid Date Format.'
  else if SameText(aCode, '50029') then result := 'Merchant Closed.'
  else if SameText(aCode, '800002') then result := 'Given Credentials are not authenticated and/or Access Denied.'
  else if SameText(aCode, '51500') then result := 'recurProfCrta.id can only be set for non-TransFirst user.'
  else if SameText(aCode, '51501') then result := 'prodCrta is set and also recurProfCrta or custCrta is set.'
  else if SameText(aCode, '51502') then result := 'The customer type should be set when recurProfCrta or custCrta is set and not when prodCrta is set.'
  else if SameText(aCode, '51300') then result := 'Failed creating Iso8583Post message.'
  else if SameText(aCode, '51301') then result := 'Duplicate user-defined name.'
  else if SameText(aCode, '51302') then result := 'Failed creating SendTranResponse message.'
  else if SameText(aCode, '51303') then result := 'UCAF data is expected but not set.'
  else if SameText(aCode, '51304') then result := 'UCAF data is set but not expected.'
  else if SameText(aCode, '51305') then result := 'Discount amount not set but expected.'
  else if SameText(aCode, '51306') then result := 'Merchant ID is expected but not set.'
  else if SameText(aCode, '51307') then result := 'PAN, expiry date, security code, or sequence number is set but not expected. This happens when Track 2 is also present.'
  else if SameText(aCode, '51308') then result := 'Track data or PAN failed format validation.'
  else if SameText(aCode, '51309') then result := 'Track 2 and PAN are not set, but one is expected.'
  else if SameText(aCode, '51310') then result := 'card.dbtOrCdt is set to 0, but the card.type is not VISA or MasterCard.'
  else if SameText(aCode, '51311') then result := 'Extra data set but not expected.'
  else if SameText(aCode, '51312') then result := 'Track 2 data is expected but not set.'
  else if SameText(aCode, '51313') then result := 'Authorization request element is set but not expected.'
  else if SameText(aCode, '51314') then result := 'Card element is expected but not set.'
  else if SameText(aCode, '51315') then result := 'DbtOrCdt element is set to an unexpected value.'
  else if SameText(aCode, '51316') then result := 'UCAF data and/or UCAF indicator are set but not expected.'
  else if SameText(aCode, '51317') then result := 'Transaction data element is set but not expected.'
  else if SameText(aCode, '51318') then result := 'Recurring payment element is set but not expected.'
  else if SameText(aCode, '51319') then result := 'Reverse Auth on Void element is set but not expected.'
  else if SameText(aCode, '51320') then result := 'usrDef.val element is expected but not set.'
  else if SameText(aCode, '51321') then result := 'Invalid POS Entry Mode.'
  else if SameText(aCode, '51322') then result := 'Invalid Cardholder Authentication Capability.'
  else if SameText(aCode, '51323') then result := 'Invalid Cardholder Authentication Method.'
  else if SameText(aCode, '51324') then result := 'usrDef is expected but not set.'
  else if SameText(aCode, '51325') then result := 'Invalid Cardholder Present.'
  else if SameText(aCode, '51326') then result := 'Invalid Card Present.'
  else if SameText(aCode, '51327') then result := 'Invalid Card Data Input Mode.'
  else if SameText(aCode, '51328') then result := 'Recurring payment element is expected but not set.'
  else if SameText(aCode, '51329') then result := 'Initial Recurring Payment Indicator is expected but not set.'
  else if SameText(aCode, '51330') then result := 'Payment Number element is expected but not set.'
  else if SameText(aCode, '51331') then result := 'Number of Payments element is expected but not set.'
  else if SameText(aCode, '51332') then result := 'Transaction Number element is expected but not set.'
  else if SameText(aCode, '51333') then result := 'Resubmit element is set but not expected.'
  else if SameText(aCode, '51334') then result := 'Invalid Amount/Amount is set but not expected.'
  else if SameText(aCode, '51335') then result := 'Original Transaction Data element is expected but not set.'
  else if SameText(aCode, '51336') then result := 'If XID element is set, then CAVV is expected but not set.'
  else if SameText(aCode, '51337') then result := 'If CAVV element is set, then XID is expected but not set.'
  else if SameText(aCode, '51338') then result := 'Invalid Electronic Signature.'
  else if SameText(aCode, '51339') then result := 'Reverse Authorization on Void element is set but not expected.'
  else if SameText(aCode, '51340') then result := 'Managed Settlement Flag element is set but not expected.'
  else if SameText(aCode, '51341') then result := 'Expiry Date element is expected but not set.'
  else if SameText(aCode, '51342') then result := 'Address Line 1 and/or ZIP Code element are expected but not set.'
  else if SameText(aCode, '51346') then result := 'Previous Settled Amount is set but not expected.'
  else if SameText(aCode, '51347') then result := 'This transaction is not allowed on a debit card.'
  else if SameText(aCode, '51348') then result := 'Request Amount is expected but not set.'
  else if SameText(aCode, '51349') then result := 'EXTENDED_TRAN_TYPE is not set but expected in the usrDef element. EXTENDED_TRAN_TYPE is set in the usrDef element, but it does not have a 4-digit number value.'
  else if SameText(aCode, '51350') then result := 'recurMan is expected but not set.'
  else if SameText(aCode, '51351') then result := 'Voice Auth Code is set but not expected.'
  else if SameText(aCode, '51352') then result := 'Product ID does not exist.'
  else if SameText(aCode, '51353') then result := 'No connection to remote can be established.'
  else if SameText(aCode, '51354') then result := 'Payment Number or Number of Payments is set but not expected.'
  else if SameText(aCode, '51355') then result := 'Payment Number cannot be more than Number of Payments.'
  else if SameText(aCode, '51356') then result := 'Tax Amount is expected but not set.'
  else if SameText(aCode, '51357') then result := 'Tax Amount is set but not expected.'
  else if SameText(aCode, '51358') then result := 'Track 1 Data is invalid (not yet implemented).'
  else if SameText(aCode, '51359') then result := 'recurMan is set but not expected.'
  else if SameText(aCode, '51360') then result := 'For Forced Voice Authorization transactions, either the Transaction Number or both the Datetime and Auth value were set.'
  else if SameText(aCode, '51361') then result := 'The transaction Datetime provided occurs in the future.'
  else if SameText(aCode, '51362') then result := 'Card data was provided when it was not expected.'
  else if SameText(aCode, '51363') then result := 'Merchant ID was provided when it was not expected.'
  else if SameText(aCode, '51364') then result := 'Incomplete Check Details.'
  else if SameText(aCode, '51365') then result := 'ACH ID was provided when it was not expected.'
  else if SameText(aCode, '51366') then result := 'Managed Settle not allowed for Retail (Industry Code 1).'
  else if SameText(aCode, '51367') then result := 'EMAIL_ADDRESSES in the usrDef element failed validation. Must be a semicolon-separated list of valid email addresses (refer to Contact.email for valid email addresses).'
  else if SameText(aCode, '51368') then result := 'Reversal Response Code flag is set, but the Transaction Code is not 2 (Auth. Reversal) or 6 (Settle Void).'
  else if SameText(aCode, '51369') then result := 'Reversal Response Code flag is set (value 34, Suspect Fraud), but the Industry code is not 0 (Direct Marketing) or 2 (E-commerce).'
  else if SameText(aCode, '51370') then result := 'Initial Recurring Payment Indicator is set but not expected.'
  else if SameText(aCode, '51371') then result := 'Tax Indicator is expected for purchase card transactions (Deprecated).'
  else if SameText(aCode, '51372') then result := 'Invalid transaction number (data center ID not valid).'
  else if SameText(aCode, '51373') then result := 'Balance Inquiry must contain track data.'
  else if SameText(aCode, '51374') then result := 'Invalid input type for Balance Inquiry; must be web services.'
  else if SameText(aCode, '51375') then result := 'Security Info element is expected but not set.'
  else if SameText(aCode, '51376') then result := 'CardInputType element is set to a value that is not expected. Values allowed: 1 (EMV Chip), 2 (EMV contactless) or 6 (Dual interface). EMV transactions only allow values 1 (EMV Chip), 2 (EMV contactless) or 6 (Dual interface) for cardInputType field.'
  else if SameText(aCode, '51377') then result := 'CardInputType element is set to a value that is not expected. Value 5 (Tokenized) is not allowed. RecurPmt field is present and pmtFreq field does not indicate single payment.'
  else if SameText(aCode, '51378') then result := 'EmvTlvReq element is expected but not set.'
  else if SameText(aCode, '51379') then result := 'Invalid Structured data, there was a problem when it attempts to create TLV object from EmvTlvReq field.'
  else if SameText(aCode, '51380') then result := 'Failed TLV conversion, there was an error when it attempts to convert Icc data from request to TLV object.'
  else if SameText(aCode, '51381') then result := 'Invalid Trancode. Values allowed: 2 (Auth reversal), 6 (settle void) and 13 (credit or return void). Values greater than 0 (for emvDeclinedAfterOnline field) are only allowed for reversal tran codes.'
  else if SameText(aCode, '51382') then result := 'Invalid storeNr. Must be 4 characters.'
  else if SameText(aCode, '51383') then result := 'Invalid termId. Must be 4 characters.'
  else if SameText(aCode, '51400') then result := 'Customer Data with payments is provided with Existing Customer ID or Payment ID.'
  else if SameText(aCode, '51401') then result := 'Multiple Payments set for Recurring Profile.'
  else if SameText(aCode, '51402') then result := 'The Payment Update Type is set to delete while adding/updating the Recurring Profile. The Payment Update Type is set to update/delete while adding the Customer.'
  else if SameText(aCode, '51403') then result := 'The Customer Company Name is not set.'
  else if SameText(aCode, '51404') then result := 'The Customer ID is not set for the Payments.'
  else if SameText(aCode, '51405') then result := 'The Customer ID is set while adding the customer. The Customer ID was not set while updating/deleting the Customer.'
  else if SameText(aCode, '51406') then result := 'The Recurring profile and Payment Data is set while deleting the customer. The Payment and Customer Data is set while deleting the Recurring Profile.'
  else if SameText(aCode, '51407') then result := 'The Customer Update Type is set to delete while adding/updating the Recurring Profile.'
  else if SameText(aCode, '51408') then result := 'Payment not set while adding the customer for Recurring Profile.'
  else if SameText(aCode, '51409') then result := 'Payment data and Payment ID is set.'
  else if SameText(aCode, '51410') then result := 'Customer.Contact Type is not set.'
  else if SameText(aCode, '51411') then result := 'Customer.Contact Status is not set.'
  else if SameText(aCode, '51412') then result := 'Customer.Contact First name is not set.'
  else if SameText(aCode, '51413') then result := 'Customer.Contact Last Name is expected but not set.'
  else if SameText(aCode, '51414') then result := 'Customer.Contact Address Line 1 is expected but not set.'
  else if SameText(aCode, '51415') then result := 'Customer.Contact City is expected but not set.'
  else if SameText(aCode, '51416') then result := 'Customer.Contact State is expected but not set.'
  else if SameText(aCode, '51417') then result := 'Recurring Profile is not set for add/update of Recurring profile.'
  else if SameText(aCode, '51418') then result := 'The Recurring ID is set while adding the Recurring Profile. The Recurring ID was not set while updating/deleting the Recurring Profile.'
  else if SameText(aCode, '51419') then result := 'Number of Payments Set is less than Number of Payments Processed.'
  else if SameText(aCode, '51421') then result := 'PAN set is incorrect.'
  else if SameText(aCode, '51422') then result := 'Customer ID and Payment ID Provided are not linked.'
  else if SameText(aCode, '51424') then result := 'Prod Data is not set while adding/updating the Product. Prod Data is set while deleting the Product.'
  else if SameText(aCode, '51425') then result := 'Product Update Type set to delete while adding Recurring Profile.'
  else if SameText(aCode, '51426') then result := 'ACH and Card Payment set or both the payments are not set.'
  else if SameText(aCode, '51427') then result := 'The Payment ID is set while adding the Payment. The Payment ID was not set while updating/deleting the Payment.'
  else if SameText(aCode, '51428') then result := 'The bank routing number, bank name, account number, account type, or secc code is not set for ACH Payment.'
  else if SameText(aCode, '51429') then result := 'The Card PAN or Expiry Date is not set.'
  else if SameText(aCode, '51430') then result := 'For Debit Card, the Card Type is not set to Visa or MasterCard.'
  else if SameText(aCode, '51431') then result := 'Payment type is expected but not set.'
  else if SameText(aCode, '51432') then result := 'Date Parse Error.'
  else if SameText(aCode, '51433') then result := 'PAN Encryption failed.'
  else if SameText(aCode, '51434') then result := 'Linked Customer, Payment, and Product to Recurring Profile cannot be deleted.'
  else if SameText(aCode, '51435') then result := 'Adding Product and Recurring or Customer is set.'
  else if SameText(aCode, '51436') then result := 'The Product ID is set while adding the Product. The Product ID was not set while updating/deleting the Product.'
  else if SameText(aCode, '51437') then result := 'The quantity should be set when product is provided for Recurring Profile.'
  else if SameText(aCode, '51438') then result := 'Product Update Type is not set.'
  else if SameText(aCode, '51439') then result := 'Start date cannot be set to a past date. The Recurring Payments Engine is currently busy processing the Recurring Profiles. No changes to the start dates are accepted at this time.'
  else if SameText(aCode, '51440') then result := 'Zero amount is not expected.'
  else if SameText(aCode, '51441') then result := 'For Single Payment billing cycle, the number of payments must be set to 1.'
  else if SameText(aCode, '51442') then result := 'Full Name is expected but not set.'
  else if SameText(aCode, '51443') then result := 'The customer is inactive.'
  else if SameText(aCode, '51444') then result := 'User-defined field value is expected but not set.'
  else if SameText(aCode, '51445') then result := 'Amount is expected but not set. (recur.amt is a mandatory element).'
  else if SameText(aCode, '51446') then result := 'The Security code is not allowed for recurring profiles (recur.seccCode).'
  else if SameText(aCode, '51447') then result := 'The recurring profile is inactive.'
  else if SameText(aCode, '51448') then result := 'New Recurring Profile cannot be added for inactive wallet.'
  else if SameText(aCode, '51449') then result := 'ACH wallet could not be created because the merchant is not setup with a product type of ACH.'
  else if SameText(aCode, '51450') then result := 'CardInputType element is set to a value that is not expected. Only value 0 (Normal) is permitted. Attempting to create a wallet using a cardInputType value other than 0 (normal).'
  else if SameText(aCode, '51451') then result := 'CardInputType element is set to tokenized. All card types are accepted for recurring payments except tokenized.'
  else if SameText(aCode, '51452') then result := 'Recurring profile cannot be created for PayPal card type.'
end;



end.
