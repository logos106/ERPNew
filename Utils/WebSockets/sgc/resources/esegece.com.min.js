/*
**************************************************************************
 sgcWebSocket component

 written by eSeGeCe
            copyright © 2013
            Email : info@esegece.com
            Web : http://www.esegece.com
**************************************************************************
*/
function sgcws(){if(arguments.length==0){return}if(arguments.length==1){if(typeof arguments[0]=="object"){arguments[0]["subprotocol"]="esegece.com";sgcWebSocket.call(this,arguments)}else{if(typeof arguments[0]=="string"){arguments[1]="esegece.com";sgcWebSocket.call(this,arguments[0],arguments[1])}}}else{if(arguments.length==2){if(typeof arguments[0]=="object"){arguments[0]["subprotocol"]=arguments[1]+".esegece.com";sgcWebSocket.call(this,arguments)}else{if(typeof arguments[0]=="string"){arguments[1]=arguments[1]+".esegece.com";sgcWebSocket.call(this,arguments[0],arguments[1])}}}}var e=this.send;this.send=function(j,l,i,k){if(arguments.length==1){arguments[0]='{"jsonrpc":"2.0", "method":"sgc@message", "params":{"message":"'+j+'"}, "id":"'+GUID()+'"}'}else{if(arguments.length==2){arguments[0]='{"jsonrpc":"2.0", "method":"'+l+'", "params":{"message":"'+j+'"}, "id":"'+GUID()+'"}'}else{if((k!=="")&&(k!==undefined)){arguments[0]='{"jsonrpc":"2.0", "method":"'+l+'", "params":{"channel":"'+i+'", "message":"'+j+'"}, "id":"'+k+'"}'}else{arguments[0]='{"jsonrpc":"2.0", "method":"'+l+'", "params":{"channel":"'+i+'", "message":"'+j+'"}}'}}}e.apply(this,arguments)};this.broadcast=function(){if(arguments.length==1){this.send(arguments[0],"sgc@broadcast","")}else{if(arguments.length==2){this.send(arguments[0],"sgc@broadcast",arguments[1])}}};this.publish=function(){this.send(arguments[0],"sgc@publish",arguments[1])};this.subscribe=function(i){this.send("","sgc@subscribe",i,GUID())};this.unsubscribe=function(i){this.send("","sgc@unsubscribe",i,GUID())};this.rpc=function(k,j,i){arguments[0]='{"jsonrpc":"2.0", "method":"'+j+'", "params":'+i+', "id":"'+k+'"}';e.apply(this,arguments)};this.notify=function(j,i){arguments[0]='{"jsonrpc":"2.0", "method":"'+j+'", "params":'+i+'"}';e.apply(this,arguments)};var a=new event("onsgcmessage");var g=new event("onsgcevent");var f=new event("onsgcsubscribe");var d=new event("onsgcunsubscribe");var c=new event("onsgcrpcresult");var h=new event("onsgcrpcerror");this.on("message",function(j){var i=j.message;obj=JSON.parse(i);if(obj.result!==undefined){if(obj.result.method=="sgc@subscribe"){f.fire({name:"onsgcsubscribe",channel:obj.result.channel})}else{if(obj.result.method=="sgc@unsubscribe"){d.fire({name:"onsgcunsubscribe",channel:obj.result.channel})}else{if(obj.result.method=="sgc@event"){g.fire({name:"onsgcevent",channel:obj.result.channel,message:obj.result.message})}else{if(obj.result.method=="sgc@message"){a.fire({name:"onsgcmessage",message:obj.result.message})}else{c.fire({name:"onsgcrpcresult",result:obj.result,id:obj.id})}}}}}else{if(obj.error!==undefined){h.fire({name:"onsgcrpcerror",code:obj.error.code,message:obj.error.message,data:obj.error.data})}}});var b=this.on;this.on=function(i,j){if(i=="sgcmessage"){a.subscribe(j)}else{if(i=="sgcevent"){g.subscribe(j)}else{if(i=="sgcsubscribe"){f.subscribe(j)}else{if(i=="sgcunsubscribe"){d.subscribe(j)}else{if(i=="sgcrpcresult"){c.subscribe(j)}else{if(i=="sgcrpcerror"){h.subscribe(j)}else{b.apply(this,arguments)}}}}}}}}sgcws.prototype=new sgcWebSocket();sgcws.prototype.constructor=sgcws;