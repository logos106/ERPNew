/*
**************************************************************************
 sgcWebSocket component

 written by eSeGeCe
            copyright © 2013
            Email : info@esegece.com
            Web : http://www.esegece.com
**************************************************************************
*/
function sgcws_dataset(){if(arguments.length==0){return}if(arguments.length==1){if(typeof arguments[0]=="object"){arguments[0]["subprotocol"]="dataset.esegece.com";sgcWebSocket.call(this,arguments)}else{if(typeof arguments[0]=="string"){arguments[1]="dataset.esegece.com";sgcWebSocket.call(this,arguments[0],arguments[1])}}}else{if(arguments.length==2){if(typeof arguments[0]=="object"){arguments[0]["subprotocol"]=arguments[1]+".dataset.esegece.com";sgcWebSocket.call(this,arguments)}else{if(typeof arguments[0]=="string"){arguments[1]=arguments[1]+".dataset.esegece.com";sgcWebSocket.call(this,arguments[0],arguments[1])}}}}var e=this.send;this.send=function(h,j,g,i){if(arguments.length==1){arguments[0]='{"jsonrpc":"2.0", "method":"sgc@message", "params":{"message":"'+h+'"}, "id":"'+GUID()+'"}'}else{if(arguments.length==2){arguments[0]='{"jsonrpc":"2.0", "method":"'+j+'", "params":{"message":"'+h+'"}, "id":"'+GUID()+'"}'}else{if((i!=="")&&(i!==undefined)){arguments[0]='{"jsonrpc":"2.0", "method":"'+j+'", "params":{"channel":"'+g+'", "message":"'+h+'"}}'}else{arguments[0]='{"jsonrpc":"2.0", "method":"'+j+'", "params":{"channel":"'+g+'", "message":"'+h+'"}, "id":"'+i+'"}'}}}e.apply(this,arguments)};this.broadcast=function(){if(arguments.length==1){this.send(arguments[0],"sgc@broadcast","")}else{if(arguments.length==2){this.send(arguments[0],"sgc@broadcast",arguments[1])}}};this.subscribe=function(g){this.send("","sgc@subscribe",g,GUID())};this.unsubscribe=function(g){this.send("","sgc@unsubscribe",g,GUID())};this.subscribe_all=function(){this.subscribe("sgc@dataset@new");this.subscribe("sgc@dataset@update");this.subscribe("sgc@dataset@delete")};this.unsubscribe_all=function(){this.unsubscribe("sgc@dataset@new");this.unsubscribe("sgc@dataset@update");this.unsubscribe("sgc@dataset@delete")};var a=new event("onsgcmessage");var f=new event("onsgcsubscribe");var d=new event("onsgcunsubscribe");var c=new event("onsgcdataset");this.on("message",function(h){var g=h.message;obj=JSON.parse(g);if(obj.result!==undefined){if(obj.result.method=="sgc@subscribe"){f.fire({name:"onsgcsubscribe",channel:obj.result.channel})}else{if(obj.result.method=="sgc@unsubscribe"){d.fire({name:"onsgcunsubscribe",channel:obj.result.channel})}else{if(obj.result.method=="sgc@dataset"){c.fire({name:"onsgcdataset",channel:obj.result.channel,dataset:obj.result.dataset})}else{if(obj.result.method=="sgc@message"){a.fire({name:"onsgcmessage",message:obj.result.message})}}}}}});var b=this.on;this.on=function(g,h){if(g=="sgcdataset"){c.subscribe(h)}else{if(g=="sgcmessage"){a.subscribe(h)}else{if(g=="sgcsubscribe"){f.subscribe(h)}else{if(g=="sgcunsubscribe"){d.subscribe(h)}else{b.apply(this,arguments)}}}}}}sgcws_dataset.prototype=new sgcWebSocket();sgcws_dataset.prototype.constructor=sgcws_dataset;